<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Playcorder tests</title>
    <link rel="stylesheet" type="text/css" href="mocha.css"/>
    <style>
        .hide {
            display: none
        }

        .clearfix {
            clear: both
        }
    </style>
    <!-- VIDEO  RESPONDENT TEST PAGE - HEAD - START  -->
    <!-- Configuration file -->
    <!-- Mandatory files -->
    <script type="text/javascript" charset="utf-8" src="jquery-1.9.1.js"></script>

    <!-- Recorder files -->
    <script type="text/javascript" charset="utf-8" src="../libs/swfobject.js"></script>
    <script type="text/javascript" charset="utf-8" src="../recorder/var.js"></script>

    <!-- Client files -->
    <script type="text/javascript" charset="utf-8" src="../APIClient/sha256.js"></script>
    <script type="text/javascript" charset="utf-8" src="../APIClient/enc-base64-min.js"></script>
    <script type="text/javascript" charset="utf-8" src="../APIClient/store.js"></script>
    <script type="text/javascript" charset="utf-8" src="../APIClient/CEClient.js"></script>

    <!-- Video js files -->
    <script type="text/javascript" charset="utf-8" src="../libs/video-js-4-7/video.dev.js"></script>
    <link type="text/css" href="../libs/video-js-4-7/video-js.min.css" rel="stylesheet">


    <script type="text/javascript" charset="utf-8"  src="../vrtk_player.js"></script>
    <script type="text/javascript" charset="utf-8" src="../vrtk.js"></script>

    <script type="text/javascript" charset="utf-8">
        function alertMessage(msg) {
            if (console.log)console.log(msg);
        }
        $(document).ready(function () {

            var vrt = new Vrt(
                    'youtube'
                    , [
                        {
                            'path': 'https://www.youtube.com/watch?v=IFACrIx5SZ0',
                            'length': 10,
                            'name': 'Attenborough: Amazing DIY Orangutans - BBC Earth'
                        }
                        , {
                            'path': 'https://www.youtube.com/watch?v=ndMKTnSRsKM',
                            'length': 10,
                            'name': 'Attenborough: Saying Boo to a Sloth! - BBC Earth'
                        }
                    ]
                    , 'mediastream_ulr'
                    , 'mediastream_name'
                    , 'api_url'
                    , 'api_user'
                    , 'api_pw'
                    , {
                        debug: true,
                        debugChrono: true,
                        debugChronoHtml: false,
                        debugEvt: true,
                        debugVImportant: true,
                        randomOrder: true,
                        playerCentered: false,
                        recorderCenter: false,
                        swfPath: '../../dist/'
                        /*, playerCentered:true, playerWidth: 400, playerHeight: 300 */
                    }
            );

            // show start button
            /*
            $(vrt).on('vrt_event_producer_camera_ok', function () {
                alertMessage();
                $('#start').show();
            });
            // watch first video
            $('#start').on('click', function () {
                alertMessage();
                $('#start').hide();
                $(vrt).trigger('vrt_event_start_video_session');
            });
            // watch next video
            $(vrt).on('vrt_event_video_step_completed', function (evt, data) {

                alertMessage();
                //$('#next').show();
                if (data.responseId) {
                    alertMessage('Facevideo uploaded with response id: ' + data.responseId);
                }
                vrt.openFrame('https://docs.google.com/forms/d/1afP8KJKFIF3AMfAAjKqaLtLoFIdr5S3rSMRn2FCVyek/viewform',
                        {
                            btnCssClass: 'button-choose pure-button',
                            btnPosition: 'top',
                            btnText: 'Next',
                            btnStyle: 'position: static; margin-bottom: 1em;'
                        }
                );
            });
            $(vrt).on('vrt_event_frame_close', function (evt, data) {
                alertMessage();
                $(vrt).trigger('vrt_event_user_next_video');
                //$('#next').show();
            });

            //end session
            $(vrt).on('vrt_event_video_session_complete', function () {
                alertMessage();
                $('#next').hide();
                $('#end').show();
            });
            $('#end').on('click', function () {
                alertMessage();
                $('#end').hide();
                $(vrt).trigger('vrt_event_user_session_complete');
            });

            //alerts
            //no api login
            $(vrt).on('vrt_event_api_login_fail', function () {
                alertMessage('Error: API login fail');
            });
            //no camera
            $(vrt).on('vrt_event_producer_no_camera_found', function () {
                alertMessage('Error: No webcam found');
            });
            //camera blocked
            $(vrt).on('vrt_event_producer_camera_blocked', function () {
                alertMessage('Error: Webcam blocked by user');
            });
            //wating user permission for webcam
            $(vrt).on('vrt_event_producer_camera_muted', function () {
                alertMessage('Please click on the "Allow" button in the Adobe Flash Player security request');
            });
            //no Flash
            $(vrt).on('vrt_event_flash_no', function () {
                alertMessage('Error: no Adobe Flash founded');
            });
            //old Flash version
            $(vrt).on('vrt_event_flash_old', function () {
                alertMessage('Error: the version of Adobe Flash is old');
            });
*/
            vrt.init();
        });
    </script>
    <!-- EXAMPLE OF IMPLEMENTATION END -->

    <!-- TESTS START -->
    <script type="text/javascript" src="mocha.js"></script>
    <script type="text/javascript" src="chai.js"></script>
    <script type="chai-as-promised"></script>
    <script type="text/javascript" src="sinon.js"></script>
    <script type="text/javascript" src="tests.js"></script>
    <!-- TESTS END -->

</head>
<body>

<!-- Playcorder START -->
<div id="introzone" class="">

    <div id="vrt" style=""></div>

    <div id="alerts"></div>


    <div id="buttons">
        <button id="start" class="hide button-choose pure-button">Start Session</button>
        <button id="next" class="hide button-choose pure-button">Next video</button>
        <button id="end" class="hide button-choose pure-button">End</button>
    </div>

</div>
<!-- Playcorder END -->

<!-- TESTS START -->
<div id="mocha"></div>

<!-- TESTS END -->
</body>
</html>


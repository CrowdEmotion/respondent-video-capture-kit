<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link type="text/css" href="https://cdn.crowdemotion.co.uk/playcorder/v3/vrtk-v3.min.css" rel="stylesheet">
    <script type="text/javascript" charset="utf-8" src="//code.jquery.com/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" charset="utf-8"
            src="https://cdn.crowdemotion.co.uk/playcorder/v3/vrtk-v3.all.js"></script>


    <script type="text/javascript" charset="utf-8">

        // example implementation

        //DEMO SCRIPTS
        $(document).ready(function () {
            var mail = '';
            $("#proceed").click(function (event) {
                mail = $('#mail').val();
                vrt.ceclient.writeRespondentCustomData(vrt.respondentId, {mail: mail})
                $('#intro').slideUp('slow', function () {
                    $('#main').slideDown('slow')
                });
            });

            $("#send").click(function (event) {
                var msg = $('#message').val();
                vrt.ceclient.writeRespondentCustomData(vrt.respondentId, {feedback: msg})
                $('#message').slideUp('slow', function () {
                    $('#send').slideUp('slow')
                });
                $('#feedbackarea').html('Thank you for feedback');
            });

        });
        $(document).ready(function () {
            var fullscreen = getParameterByName('fullscreen');
            fullscreen = (fullscreen == null || fullscreen == undefined) ? false : true;
            var playercentered = getParameterByName('playercentered');
            playercentered = (playercentered == null || playercentered == undefined) ? false : true;
            var recordercenter = getParameterByName('recordercenter');
            recordercenter = (recordercenter == null || recordercenter == undefined) ? false : true;
            var randomorder = getParameterByName('randomorder');
            randomorder = (randomorder == null || randomorder == undefined) ? false : true;


            // one YT video, two YT video, one mp4 video, two MP4 videos

            var rTokens = ['73ab3ef4ce45df9dc109e92b562fc2f0d8d8c09c', '0632beb535cd313d37b3686b8e6134585e543493', 'd331f6ce615640acf0f64a2fdf2d301354a32b88', '67e4592ca7787b4348277cd4214ef1c40a295c87'];
            var aTokens = ['9735c2f5-8129-4610-a4b4-7c132d3aa5ca', 'ac377ece-23e4-4481-b729-f9bae602d17f', 'ac377ece-23e4-4481-b729-f9bae602d17f', 'ac377ece-23e4-4481-b729-f9bae602d17f'];

            var researchToken = getParameterByName('r') ? rTokens[getParameterByName('r')] : rTokens[0];
            var appToken = getParameterByName('r') ? aTokens[getParameterByName('r')] : aTokens[0];

            //YT d15aa84c29634c852e612ddd066fe0fece837bc6
            //custom server 7674cb8779c471c401d5e11efc7fcffbf6f16eb8
            var options = {
                researchToken: 'd15aa84c29634c852e612ddd066fe0fece837bc6',
                appToken: '8a111f27-b9d4-438d-8559-fb38cc19af5b',
                streamName: 'ce-demo1_',
                apiSandbox: true,
                debug: true,
                respondentCustomData: {user_video_behavior: 'delete_video'},
                playerCentered: playercentered,
                recorderCenter: recordercenter,
                fullscreen: fullscreen,
                randomOrder: randomorder,
                savePlatform: true
            };

            var vrt = new Vrt(options);

            var alertMessage = function (msg) {
                if (msg == undefined || msg == null) {
                    $('#alerts').html('');
                    $('#alerts').removeClass('pure-button');
                    $('#alerts').removeClass('button-b');
                } else {
                    $('#alerts').html(msg);
                    $('#alerts').addClass('pure-button');
                    $('#alerts').addClass('button-b');
                }
            };

            $('#alerts').on('click', function () {
                alertMessage();
            });


            // show start button
            $(vrt).on('vrt_event_producer_camera_ok', function () {
                alertMessage();
                $('#start').show();

            });
            // watch first video
            $('#start').on('click', function () {
                alertMessage();
                $('#start').hide();
                $(vrt).trigger('vrt_event_start_video_session');
                if (vrt.continuosPlay !== true)$('#next').show();
            });
            // watch next video
            $(vrt).on('vrt_event_video_step_completed', function (evt, data) {
                alertMessage();

                if (data.responseId) {
                    alertMessage('Facevideo uploaded with response id: ' + data.responseId);
                    var d = new Date();
                    window.vrt.apiClientSaveCustomData(data.responseId, {time: d.getTime()});
                }

            });
            $(vrt).on('vrt_event_frame_close', function (evt, data) {
                alertMessage();
                $(vrt).trigger('vrt_event_user_next_video');
                $('#next').show();
            });

            $('#next').on('click', function () {
                if (vrt.continuosPlay !== true) {
                    alertMessage();
                    $(vrt).trigger('vrt_event_user_next_video');
                }
            });

            //end session
            $(vrt).on('vrt_event_video_session_complete', function () {
                alertMessage();
                //$('#next').hide();
                $('#end').show();
            });
            $('#end').on('click', function () {
                alertMessage();
                $('#end').hide();
                $(vrt).trigger('vrt_event_user_session_complete');
            });

            //alerts
            //no api login
            $(vrt).on('vrt_event_api_login_fail', function () {
                alertMessage('Error: API login fail');
                alert('No API login');
            });
            //no camera
            $(vrt).on('vrt_event_producer_no_camera_found', function () {
                alertMessage('Error: No webcam found');
                alert('Your computer have no webcam')
            });
            //camera blocked
            $(vrt).on('vrt_event_producer_camera_blocked', function () {
                alertMessage('Error: Webcam blocked by user');
            });
            //wating user permission for webcam
            $(vrt).on('vrt_event_producer_camera_muted', function () {
                alertMessage('Please click on the "Allow" on your webcam request');
            });
            $(vrt).on('vrt_event_fatal_error', function () {
                alertMessage('FATAL ERROR ');
            });


            vrt.init();


            function save_feedback(save) {
                vrt.ceclient.writeRespondentCustomData(vrt.respondentId, {feedback: save})
            };
        });

        function getParameterByName(name) {
            var match = RegExp('[?&]' + name + '=([^&]*)').exec(window.location.search);
            return match && decodeURIComponent(match[1].replace(/\+/g, ' '));
        }


    </script>

    <style>
        .hide {
            display: none;
        }

        .clearfix {
            clear: both;
        }

        header, article {
            clear: both;
        }

        .block {
            display: block;
        }

        .inline {
            display: inline;
        }

        .floatleft {
            float: left;
        }

        .floatright {
            float: right;
        }

        #intro, #main {
            border: 1px #d8d8d8 solid;
            border-radius: 10px;
            margin: 10px;
            padding: 10px;
        }

        .vrtbtn {
            border: 1px #6a6a6a solid;
            border-radius: 5px;
            margin: 10px;
            padding: 10px;
            width: 150px;
            color: white;
            background-color: rgba(29, 130, 183, 1);
        }

        .vrtinput {
            border: 1px #6a6a6a solid;
            border-radius: 5px;
            margin: 10px;
            padding: 10px;
        }

        textarea.vrtinput {
            width: 300px;
            height: 200px;
        }

        #alerts.pure-button{
            padding: 5px;
            margin: 0 5px;
        }
        #alerts {
            background-color: #FFCA00;

        }
    </style>

</head>

<body>
<header id="header">
    <div class="banner-head">
        <img src="https://cdn.crowdemotion.co.uk/images/logo320_100.jpg" align="left">

        <h1>Playcorder Demo</h1>
    </div>
</header>

<article id="content">


    <section id="intro">
        <h3>Welcome to Playcorder Demo</h3>
        We use facial recognition to tease out how audiences emotionally engage with videos.<br/>
        It adds a whole new layer of insight above and beyond what our audiences claim.<br/>
        Watch two shorts videos. Is the video a Guilty Pleasure for you or do you Love it?<br/>
        Click Next to find out.<br/>
        <label class="block"> Before proceed, please leave you mail. We will contact you only for feedback
            <input id="mail" name="mail" placeholder="please insert you mail" value="" class="vrtinput"/>
        </label>
        <quote class="block">Your videos will be deleted after analysis</quote>
        <input id="proceed" name="proceed" value="Proceed" class="vrtbtn"/>
    </section>
    <section id="main" class="hide">
        <div id="alerts" class=""></div>
        <div id="buttons" class="">
            <div id="start" class="hide vrtbtn">Start Session</div>
            <div id="next" class="hide vrtbtn">Skip/Next video</div>
        </div>
        <div id="vrt" style=""></div>
        <aside id="feedbackarea">
            <label for="message" class="block">Please, can you describe your experience? </label>
         <textarea id="message" name="message" placeholder="Please write any feedback or bugs" value=""
                   class="vrtinput"></textarea>
            <input id="send" name="send" value="Send feedback" class="vrtbtn"/>
        </aside>

    </section>

    <div id="notice"></div>

</article>

</body>
</html>
